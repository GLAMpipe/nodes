{"remainingRequest":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/components/DBFacet.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/components/DBFacet.vue","mtime":1632325376672},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5wb2ludGVyIHsKCWN1cnNvcjogcG9pbnRlcgp9Cg=="},{"version":3,"sources":["DBFacet.vue"],"names":[],"mappings":";AACA;AACA;AACA","file":"DBFacet.vue","sourceRoot":"src/components","sourcesContent":["<style>\n.pointer {\n\tcursor: pointer\n}\n</style>\n\n<template>\n  <div class=\"hello\">\n\t<b-card v-for=\"facet in facets\" v-bind:key=\"facet.key\" :title=\"facet.title\">\n\t\t<b-list-group v-for=\"fdata in facet_data[facet.key]\" :key=\"fdata._id\">\n\t\t\t<b-list-group-item class=\"pointer\" @click=\"updateData(facet, fdata._id)\">{{fdata._id}} ({{fdata.count}})\n\t\t\t</b-list-group-item>\n\t\t</b-list-group>\n\n\t</b-card>\n\n\n  </div>\n</template>\n\n<script>\nimport web from './../web.js'\n\nexport default {\n\tname: 'DBFacet',\n\tdata() {\n\t\treturn {\n\t\t\t//facet_values: [],\n\t\t\tfacets: [],\n\t\t\tfilters: [],\n\t\t\tfacet_data: {},\n\t\t\tfacet_selections: {},\n\t\t\tdata: []\n\t\t}\n\t},\n\twatch: {\n\t\t'$parent.settings': function() {\n\t\t\tconsole.log('config updated')\n\t\t\tthis.parseFacets()\n\t\t\tthis.loadFacetData()\n\t\t}\n\t},\n\tmethods: {\n\t\tsetFacetValues(values) {\n\t\t\tfor(var key in values) {\n\t\t\t\tvar facet = this.facets.find(f => f.key === key)\n\t\t\t\tfacet.values = values\n\t\t\t}\n\t\t},\n\t\tsetFacetSelection(facet, value) {\n\t\t\tif(facet.key in this.facet_selections) {\n\t\t\t\tif(this.facet_selections[facet.key].includes(value)) {\n\t\t\t\t\t// remove value\n\t\t\t\t\tthis.facet_selections[facet.key] = this.facet_selections[facet.key].filter(item => item !== value)\n\t\t\t\t} else {\n\t\t\t\t\tthis.facet_selections[facet.key].push(value)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.$set(this.facet_selections, facet.key, [value])\n\t\t\t\t//this.facet_selections[facet.key] = [value]\n\t\t\t}\n\t\t},\n\t\tasync loadFacetData() {\n\t\t\tvar facet_fields = this.facets.map(f => f.key)\n\t\t\tvar query = web.getURLQueryParamsAsString()\n\t\t\tvar response = await web.getFacetValues(this.$parent.settings.collection, facet_fields.join('|'), query)\n\t\t\tthis.facet_data = response.data[0]\n\t\t\t//this.setFacetValues(response.data[0])\n\t\t\t//axios.get(`/api/v2/collections/${this.$parent.settings.collection}/facet?fields=${facet_fields.join(',')}${url}`).then(result => {\n\t\t\t\t//this.facets = Object.keys(result.data[0])\n\t\t\t\t//this.facet_data = result.data[0]\n\t\t\t\t//this.setFacetValues(result.data[0])\n\t\t\t//})\n\t\t},\n\t\tparseFacets() {\n\t\t\tthis.facets = []\n\t\t\tif(this.$parent.settings.filters) {\n\t\t\t\tfor(var f of this.$parent.settings.filters) {\n\t\t\t\t\tf.values = []\n\t\t\t\t\tif(f.mode == 'facet') {\n\t\t\t\t\t\tthis.facets.push(f)\n\t\t\t\t\t\t//this.$set(this.facet_values, f.key, []) // make key reactive\n\t\t\t\t\t}\n\t\t\t\t\tif(f.mode == 'filter') this.filters.push(f)\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\treset() {\n\t\t\tconsole.log('facet reset')\n\t\t\tfor(var facet in this.facet_selections) {\n\t\t\t\tconsole.log(facet)\n\t\t\t\tthis.facet_selections[facet] = []\n\t\t\t}\n\t\t\tthis.$router.push({ query: this.facet_selections})\n\t\t\tthis.loadFacetData()\n\t\t},\n\t\tasync updateData(facet, facet_value) {\n\t\t\tthis.setFacetSelection(facet, facet_value)\n\t\t\tthis.$router.push({ query: this.facet_selections})\n\t\t\tthis.loadFacetData()\n\t\t}\n\n\t}\n}\n\n</script>\n"]}]}