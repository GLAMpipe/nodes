{"remainingRequest":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/components/DBDataTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/components/DBDataTable.vue","mtime":1634735274669},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgd2ViIGZyb20gJy4vLi4vd2ViLmpzJwoKZXhwb3J0IGRlZmF1bHQgewoJbmFtZTogJ0RCRGF0YVRhYmxlJywKCWRhdGEoKSB7CgkJcmV0dXJuIHsKCQkJZGF0YTogW10sCgkJCWZpZWxkczogW10KCQl9Cgl9LAoJbWV0aG9kczogewoJCWZvcm1hdFJlY29uY2lsaWF0aW9uUmVzdWx0KHdkX3Jlc3VsdCwgZGF0YSkgewoJCQl2YXIgb3V0ID0gJzx0YWJsZT4nCgkJCWlmKGRhdGEud2RfbWF0Y2gpIHsKCQkJCXJldHVybiBgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnkiIG9uY2xpY2s9IndpbmRvdy50YWJsZS5zZXRTZWxlY3Rpb24oJyR7ZGF0YS5faWR9JywgJycpIj5DaGFuZ2Ugc2VsZWN0aW9uIDwvYnV0dG9uPiAoJHt3ZF9yZXN1bHQucmVzdWx0Lmxlbmd0aH0gc3VnZ2VzdGlvbnMpYAoJCQl9CgkJCWlmKHdkX3Jlc3VsdC5yZXN1bHQpIHsKCQkJCWZvcih2YXIgciBvZiB3ZF9yZXN1bHQucmVzdWx0KSB7CgkJCQkJaWYoci5tYXRjaCkgewoJCQkJCQlvdXQgKz0gYDxiIGNsYXNzPSJ0ZXh0LWluZm8iPiR7ci5uYW1lfSAke3IuaWR9PC9iPmAKCQkJCQl9IGVsc2UgewoJCQkJCQlpZihyLnNjb3JlID09IDEwMCkKCQkJCQkJCW91dCArPSBgPHRyPjx0ZD48Yj4ke3IubmFtZX08L2I+PC90ZD48dGQ+ICR7ci5pZH0gPC90ZD48dGQ+ICR7ci5zY29yZX08L3RkPjx0ZD48YnV0dG9uIG9uY2xpY2s9IndpbmRvdy50YWJsZS5zZXRTZWxlY3Rpb24oJyR7ZGF0YS5faWR9JywgJyR7ci5pZH0nKSIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgdHlwZT0iYnV0dG9uIj5zZWxlY3Q8L2J1dHRvbj48L3RkPjwvdHI+YAoJCQkJCQllbHNlCgkJCQkJCQlvdXQgKz0gYDx0cj48dGQ+JHtyLm5hbWV9PC90ZD48dGQ+ICR7ci5pZH0gJHtyLnNjb3JlfTwvdGQ+PC90cj5gCgkJCQkJfQoJCQkJCS8vdmFyIG1hdGNoZWRfYnkgPSAnJwoJCQkJfQoJCQl9CgkJCXJldHVybiBvdXQgKyAnPC90YWJsZT4nCgkJfSwKCQlmb3JtYXRSZWNvbmNpbGlhdGlvbk1hdGNoKHdkX21hdGNoLCBkYXRhKSB7CgkJCXJldHVybiB0aGlzLnBpY2tXSUQod2RfbWF0Y2gsIGRhdGEpCgkJfSwKCQlwaWNrV0lEKHdpZCwgZGF0YSkgewoJCQl2YXIgb3V0ID0gJycKCQkJaWYoZGF0YS53ZF9yZXN1bHQucmVzdWx0KSB7CgkJCQlmb3IodmFyIHIgb2YgZGF0YS53ZF9yZXN1bHQucmVzdWx0KSB7CgkJCQkJaWYoci5pZCA9PSB3aWQpIHsKCQkJCQkJb3V0ICs9IGA8YiBjbGFzcz0idGV4dC1pbmZvIj4ke3IubmFtZX0gKDxhIGhyZWY9IiI+JHtyLmlkfTwvYT4pPC9iPmAKCQkJCQl9CgkJCQl9CgkJCX0KCQkJcmV0dXJuIG91dAoJCX0sCgkJYXN5bmMgc2V0U2VsZWN0aW9uKGRvY19pZCwgc2VsZWN0aW9uKSB7CgkJCWNvbnNvbGUubG9nKGRvY19pZCkKCQkJdmFyIGRhdGEgPSB7fQoKCQkJZGF0YVt0aGlzLiRwYXJlbnQuc2V0dGluZ3MubWF0Y2hfZmllbGRdID0gc2VsZWN0aW9uCgkJCWF3YWl0IHdlYi5zZXREYXRhKHRoaXMuJHBhcmVudC5zZXR0aW5ncy5jb2xsZWN0aW9uLCBkb2NfaWQsIGRhdGEpCgkJCWxldCByZXN1bHQgPSBhd2FpdCB3ZWIuZ2V0RGF0YSh0aGlzLiRwYXJlbnQuc2V0dGluZ3MuY29sbGVjdGlvbiwgd2ViLmdldFVSTFF1ZXJ5UGFyYW1zQXNTdHJpbmcoKSkKCQkJdGhpcy5kYXRhID0gcmVzdWx0LmRhdGEuZGF0YQoJCX0KCX0sCgoJd2F0Y2g6IHsKCQknJHBhcmVudC5zZXR0aW5ncyc6IGFzeW5jIGZ1bmN0aW9uKCkgewoJCQl0aGlzLmZpZWxkcyA9IHRoaXMuJHBhcmVudC5zZXR0aW5ncy52aXNpYmxlX2ZpZWxkcwoJCQlsZXQgcmVzdWx0ID0gYXdhaXQgd2ViLmdldERhdGEodGhpcy4kcGFyZW50LnNldHRpbmdzLmNvbGxlY3Rpb24sIHdlYi5nZXRVUkxRdWVyeVBhcmFtc0FzU3RyaW5nKCkpCgkJCXRoaXMuZGF0YSA9IHJlc3VsdC5kYXRhLmRhdGEKCQl9Cgl9LAoJbW91bnRlZDogZnVuY3Rpb24gKCkgewoJCXdpbmRvdy50YWJsZSA9IHRoaXM7IC8vIGhhY2tpc2g6IGV4cG9zZSBtZXRob2RzIGZvciBwbGFpbiBqcyAic2VsZWN0IiBidXR0b25zCgl9Cn0KCg=="},{"version":3,"sources":["DBDataTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DBDataTable.vue","sourceRoot":"src/components","sourcesContent":["<template>\n\t<div class=\"data\">\n\t\t<b-table striped hover :items=\"data\" :fields=\"fields\">\n\t\t\t<template #cell(wd_match)=\"data\">\n\t\t\t\t<div v-html=\"formatReconciliationMatch(data.value, data.item)\"></div>\n\t\t\t</template>\n\t\t\t<template #cell(wd_result)=\"data\">\n\t\t\t\t<div v-html=\"formatReconciliationResult(data.value, data.item)\"></div>\n\t\t\t</template>\n\t\t</b-table>\n\n\t</div>\n</template>\n\n<script>\n\nimport web from './../web.js'\n\nexport default {\n\tname: 'DBDataTable',\n\tdata() {\n\t\treturn {\n\t\t\tdata: [],\n\t\t\tfields: []\n\t\t}\n\t},\n\tmethods: {\n\t\tformatReconciliationResult(wd_result, data) {\n\t\t\tvar out = '<table>'\n\t\t\tif(data.wd_match) {\n\t\t\t\treturn `<button class=\"btn btn-outline-primary\" onclick=\"window.table.setSelection('${data._id}', '')\">Change selection </button> (${wd_result.result.length} suggestions)`\n\t\t\t}\n\t\t\tif(wd_result.result) {\n\t\t\t\tfor(var r of wd_result.result) {\n\t\t\t\t\tif(r.match) {\n\t\t\t\t\t\tout += `<b class=\"text-info\">${r.name} ${r.id}</b>`\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(r.score == 100)\n\t\t\t\t\t\t\tout += `<tr><td><b>${r.name}</b></td><td> ${r.id} </td><td> ${r.score}</td><td><button onclick=\"window.table.setSelection('${data._id}', '${r.id}')\" class=\"btn btn-primary\" type=\"button\">select</button></td></tr>`\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tout += `<tr><td>${r.name}</td><td> ${r.id} ${r.score}</td></tr>`\n\t\t\t\t\t}\n\t\t\t\t\t//var matched_by = ''\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn out + '</table>'\n\t\t},\n\t\tformatReconciliationMatch(wd_match, data) {\n\t\t\treturn this.pickWID(wd_match, data)\n\t\t},\n\t\tpickWID(wid, data) {\n\t\t\tvar out = ''\n\t\t\tif(data.wd_result.result) {\n\t\t\t\tfor(var r of data.wd_result.result) {\n\t\t\t\t\tif(r.id == wid) {\n\t\t\t\t\t\tout += `<b class=\"text-info\">${r.name} (<a href=\"\">${r.id}</a>)</b>`\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn out\n\t\t},\n\t\tasync setSelection(doc_id, selection) {\n\t\t\tconsole.log(doc_id)\n\t\t\tvar data = {}\n\n\t\t\tdata[this.$parent.settings.match_field] = selection\n\t\t\tawait web.setData(this.$parent.settings.collection, doc_id, data)\n\t\t\tlet result = await web.getData(this.$parent.settings.collection, web.getURLQueryParamsAsString())\n\t\t\tthis.data = result.data.data\n\t\t}\n\t},\n\n\twatch: {\n\t\t'$parent.settings': async function() {\n\t\t\tthis.fields = this.$parent.settings.visible_fields\n\t\t\tlet result = await web.getData(this.$parent.settings.collection, web.getURLQueryParamsAsString())\n\t\t\tthis.data = result.data.data\n\t\t}\n\t},\n\tmounted: function () {\n\t\twindow.table = this; // hackish: expose methods for plain js \"select\" buttons\n\t}\n}\n\n</script>\n"]}]}