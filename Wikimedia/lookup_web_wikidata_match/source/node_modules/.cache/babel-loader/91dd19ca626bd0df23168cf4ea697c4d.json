{"remainingRequest":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/babel-loader/lib/index.js!/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/eslint-loader/index.js??ref--13-0!/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/web.js","dependencies":[{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/web.js","mtime":1634813097866},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2FyaWhheXJpL1Byb2plY3RzL0dMQU1waXBlLXJld3JpdGUvbm9kZXMvV2lraW1lZGlhL2xvb2t1cF93ZWJfd2lraWRhdGFfbWF0Y2gvc291cmNlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CnZhciB3ZWIgPSB7fTsKCndlYi5nZXREYXRhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShvbmx5X21hdGNoZWQpIHsKICAgIHZhciBwYXJhbXMsIGNvbGxlY3Rpb24sIG1hdGNoLCBxdWVyeSwgcmVzdWx0OwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpOwogICAgICAgICAgICBjb2xsZWN0aW9uID0gcGFyYW1zLmdldCgiY29sbGVjdGlvbiIpOwogICAgICAgICAgICBtYXRjaCA9IHBhcmFtcy5nZXQoIm1hdGNoIik7CiAgICAgICAgICAgIHF1ZXJ5ID0gIntcIiRvclwiOlt7XCIiLmNvbmNhdChtYXRjaCwgIlwiOiB7XCIkZXhpc3RzXCI6ZmFsc2V9fSwge1wiIikuY29uY2F0KG1hdGNoLCAiXCI6XCJcIn1dfSIpOwoKICAgICAgICAgICAgaWYgKCEob25seV9tYXRjaGVkID09PSAneWVzJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICByZXR1cm4gYXhpb3MuZ2V0KCIvYXBpL3YyL2NvbGxlY3Rpb25zLyIuY29uY2F0KGNvbGxlY3Rpb24sICIvZG9jcz9tb25nb3F1ZXJ5PSIpLmNvbmNhdChxdWVyeSkpOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEzOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgIHJldHVybiBheGlvcy5nZXQoIi9hcGkvdjIvY29sbGVjdGlvbnMvIi5jb25jYXQoY29sbGVjdGlvbiwgIi9kb2NzIikpOwoKICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzdWx0KTsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp3ZWIuZ2V0U3RhdHMgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICB2YXIgcGFyYW1zLCBjb2xsZWN0aW9uLCB0b3RhbDsKICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTsKICAgICAgICAgIGNvbGxlY3Rpb24gPSBwYXJhbXMuZ2V0KCJjb2xsZWN0aW9uIik7CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICByZXR1cm4gYXhpb3MuZ2V0KCIvYXBpL3YyL2NvbGxlY3Rpb25zLyIuY29uY2F0KGNvbGxlY3Rpb24sICIvY291bnQiKSk7CgogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHRvdGFsID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgdG90YWwuZGF0YS5jb3VudCk7CgogICAgICAgIGNhc2UgNjoKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9LCBfY2FsbGVlMik7Cn0pKTsKCndlYi5zZXREYXRhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKGNvbGxlY3Rpb24sIGRvY19pZCwgZGF0YSkgewogICAgdmFyIHJlc3VsdDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnB1dCgiL2FwaS92Mi9jb2xsZWN0aW9ucy8iLmNvbmNhdChjb2xsZWN0aW9uLCAiL2RvY3MvIikuY29uY2F0KGRvY19pZCksIGRhdGEpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTMpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeDIsIF94MywgX3g0KSB7CiAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp3ZWIuZ2V0VVJMUXVlcnlQYXJhbXNBc1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICB2YXIgdXJsID0gZG9jdW1lbnQuVVJMLnNwbGl0KCc/Jyk7CiAgaWYgKHVybC5sZW5ndGggPT0gMikgcmV0dXJuIHVybFsxXS5yZXBsYWNlKC9cPy9nLCAnJyk7ZWxzZSByZXR1cm4gJyc7Cn07CgpleHBvcnQgZGVmYXVsdCB3ZWI7"},{"version":3,"sources":["/home/arihayri/Projects/GLAMpipe-rewrite/nodes/Wikimedia/lookup_web_wikidata_match/source/src/web.js"],"names":["axios","web","getData","only_matched","params","URLSearchParams","window","location","search","collection","get","match","query","result","getStats","total","data","count","setData","doc_id","put","getURLQueryParamsAsString","url","document","URL","split","length","replace"],"mappings":";;;;;;;;;;;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,IAAIC,GAAG,GAAG,EAAV;;AAGAA,GAAG,CAACC,OAAJ;AAAA,qEAAc,iBAAeC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,YAAAA,MADO,GACE,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CADF;AAEPC,YAAAA,UAFO,GAEML,MAAM,CAACM,GAAP,CAAW,YAAX,CAFN;AAGPC,YAAAA,KAHO,GAGCP,MAAM,CAACM,GAAP,CAAW,OAAX,CAHD;AAITE,YAAAA,KAJS,0BAIYD,KAJZ,0CAI6CA,KAJ7C;;AAAA,kBAMVR,YAAY,KAAK,KANP;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOGH,KAAK,CAACU,GAAN,+BAAiCD,UAAjC,8BAA+DG,KAA/D,EAPH;;AAAA;AAOZC,YAAAA,MAPY;AAAA;AAAA;;AAAA;AAAA;AAAA,mBASGb,KAAK,CAACU,GAAN,+BAAiCD,UAAjC,WATH;;AAAA;AASZI,YAAAA,MATY;;AAAA;AAAA,6CAUNA,MAVM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAd;;AAAA;AAAA;AAAA;AAAA;;AAaAZ,GAAG,CAACa,QAAJ,wEAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AACRV,UAAAA,MADQ,GACC,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CADD;AAERC,UAAAA,UAFQ,GAEKL,MAAM,CAACM,GAAP,CAAW,YAAX,CAFL;AAAA;AAAA,iBAGIV,KAAK,CAACU,GAAN,+BAAiCD,UAAjC,YAHJ;;AAAA;AAGVM,UAAAA,KAHU;AAAA,4CAIPA,KAAK,CAACC,IAAN,CAAWC,KAJJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAf;;AAOAhB,GAAG,CAACiB,OAAJ;AAAA,sEAAc,kBAAeT,UAAf,EAA2BU,MAA3B,EAAmCH,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACMhB,KAAK,CAACoB,GAAN,+BAAiCX,UAAjC,mBAAoDU,MAApD,GAA8DH,IAA9D,CADN;;AAAA;AACTH,YAAAA,MADS;AAAA,8CAENA,MAFM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAd;;AAAA;AAAA;AAAA;AAAA;;AAKAZ,GAAG,CAACoB,yBAAJ,GAAgC,YAAW;AAC1C,MAAIC,GAAG,GAAGC,QAAQ,CAACC,GAAT,CAAaC,KAAb,CAAmB,GAAnB,CAAV;AACA,MAAGH,GAAG,CAACI,MAAJ,IAAc,CAAjB,EACC,OAAOJ,GAAG,CAAC,CAAD,CAAH,CAAOK,OAAP,CAAe,KAAf,EAAsB,EAAtB,CAAP,CADD,KAGC,OAAO,EAAP;AACD,CAND;;AAQA,eAAe1B,GAAf","sourcesContent":["\nimport axios from \"axios\"\nlet web = {}\n\n\nweb.getData = async function(only_matched) {\n\tconst params = new URLSearchParams(window.location.search);\n\tconst collection = params.get(\"collection\");\n\tconst match = params.get(\"match\");\n\tvar query = `{\"$or\":[{\"${match}\": {\"$exists\":false}}, {\"${match}\":\"\"}]}`\n\tvar result\n\tif(only_matched === 'yes')\n\t\tresult = await axios.get(`/api/v2/collections/${collection}/docs?mongoquery=${query}`)\n\telse\n\t\tresult = await axios.get(`/api/v2/collections/${collection}/docs`)\n\treturn result\n}\n\nweb.getStats = async function() {\n\tconst params = new URLSearchParams(window.location.search);\n\tconst collection = params.get(\"collection\");\n\tvar total = await axios.get(`/api/v2/collections/${collection}/count`)\n\treturn total.data.count\n}\n\nweb.setData = async function(collection, doc_id, data) {\n\tvar result = await axios.put(`/api/v2/collections/${collection}/docs/${doc_id}`, data)\n\treturn result\n}\n\nweb.getURLQueryParamsAsString = function() {\n\tvar url = document.URL.split('?')\n\tif(url.length == 2)\n\t\treturn url[1].replace(/\\?/g, '')\n\telse\n\t\treturn ''\n}\n\nexport default web\n"]}]}